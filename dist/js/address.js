new Vue({
	el:'.container',
	data:{
		newAddress:{
			userName:"",
			streetName:"",
			tel:""
		},
		addressList:[],
		delFlag:false,
		editFlag:false,
		limitNum:3,
		curIndex:0,
		shipping:1,
		curAddress:'',
	},
	computed:{
		filterAddress:function(){
			//用于限制地址显示数量，开始显示三个；
			return this.addressList.slice(0,this.limitNum);
		}
	},
	mounted:function(){
		//此处代表页面加载后数据载入
		this.$nextTick(function(){
			this.getAddress();
		})
	},
	methods:{
		getAddress:function(){
			this.$http.get('data/address.json').then(function(res){
				var res=res.data;
				if(res.status==0){
					this.addressList=res.result;
				}
			});
		},
		loadMore:function(){
			this.limitNum==this.addressList.length?this.limitNum=3:this.limitNum=this.addressList.length;
		},
		setDefault:function(addressId){
			this.addressList.forEach(function(item,index){
				if(item.addressId==addressId){
					item.isDefault=true;
				}else{
					item.isDefault=false;
				}
			});
		},
		delConfirm:function(item){
			this.curAddress=item;
			this.editFlag=false;
			this.delFlag=true;
		},
		editConfirm:function(item){
			this.newAddress={
				userName:item.userName,
				streetName:item.streetName,
				tel:item.tel
			}
			this.curAddress=item;
			this.delFlag=false;
			this.editFlag=true;
		},
		delSure:function(){
			var index=this.addressList.indexOf(this.curAddress);
			this.addressList.splice(index,1);
			this.delFlag=false;
		},
		creatAddress:function(){
			this.newAddress = {userName: '', streetName: '', tel: ''}
			this.delFlag=false;
			this.editFlag=true;
			this.curAddress="";
		},
		submitAddress:function(item){
			if(item){
				if(item==this.curAddress){
					item.userName=this.newAddress.userName;
					item.streetName=this.newAddress.streetName;
					item.tel=this.newAddress.tel;
				}
			}else{
				this.addressList.unshift(this.newAddress);
            	this.newAddress = {userName: '', streetName: '', tel: ''}
			}
            // 添加完newAddress对象后，重置newAddress对象
            this.editFlag=false;
		}
	}
});